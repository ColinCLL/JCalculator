<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
</head>
<body>
	<script src = "./JCalculator.js"></script>
	<script>
  var table = [
    {time:"10月1日", inPerson:20, outPerson:1000, region: "广州",fly:12},
    {time:"10月1日", inPerson:13, outPerson:900, region: "深圳",fly:2},
    {time:"10月2日", inPerson:15, outPerson:900, region: "广州",fly:null},
    {time:"10月2日", inPerson:15, outPerson:1000, region: "深圳",fly:0},
    {time:"10月3日", inPerson:15, outPerson:100, region: "广州"},
    {time:"10月3日", inPerson:15, outPerson:100, region: "深圳"},
    {time:"10月4日", inPerson:90, outPerson:60, region: "广州"},
    {time:"10月4日", inPerson:70, outPerson:50, region: "深圳"},
    {time:"10月5日", inPerson:500, outPerson:39, region: "广州"},
    {time:"10月5日", inPerson:350, outPerson:30, region: "深圳"},
    {time:"10月6日", inPerson:900, outPerson:15, region: "广州"},
    {time:"10月6日", inPerson:1000, outPerson:15, region: "深圳"},
    {time:"10月7日", inPerson:900, outPerson:10, region: "广州"},
    {time:"10月7日", inPerson:1200, outPerson:7, region: "深圳"}
  ]

  var data1 = jc.sql({
    select: {
      sum: ["inPerson","outPerson","fly"],
      avg: ["inPerson","outPerson","fly"],
      count: "fly"
    },
    from: table
  })
  console.log("国庆广深总人口流动分析");
  console.log(data1);

  var sum1 = jc.sql({
    select: {
      sum: "inPerson"
    },
    from: table
  })
  console.log("sum1");
  console.log(sum1);

  var sum2 = jc.sql({
    select: {
      sum: ["inPerson","outPerson"]
    },
    from: table
  })
  console.log("sum2");
  console.log(sum2);
  // {sum_inPerson: 5103, sum_outPerson: 4226}

  var sum3 = jc.sql({
    select: {
      sum: {
        "流入人口总和":function  (row) {
          return row.inPerson
        },
        "流出人口总和":"outPerson",
        流动人口总和:function (row) {
          return row.inPerson + row.outPerson;
        }
      }
    },
    from: table
  })
  console.log("sum3");
  console.log(sum3);
  // 输出：{流入人口总和: 5103, 流出人口总和: 4226, 流动人口总和: 9329}

  var count = jc.sql({
    select: {
      count: ["inPerson","outPerson","fly"]
    },
    from: table
  })
  console.log("count");
  console.log(JSON.stringify(count));
  //输出：[{avg_inPerson: 364.5, avg_outPerson: 301.85714285714283, avg_fly: 4.666666666666667}]

  var data2 = jc.sql({
    select: {
      col: ["time","region"],
      sum: ["inPerson","outPerson"],
      avg: ["inPerson","outPerson"]
    },
    from: table,
    where:{region:"广州"},
    groupBy:["time","region"]
  })
  console.log("广州总人口流动分析");
  console.log(data2);


  var data3 = jc.sql({
    select: {
      col: {
        "城市":"region"
      },
      sum: {
        "流入人口总和": "inPerson",
        "流出人口总和": "outPerson",
        "流入流出人口总和": function(row){
          return row.inPerson + row.outPerson
        }
      },
      avg: {
        "流入人口平均数":"inPerson",
        "流出人口平均数":"outPerson",
        "流入流出人口平均数":function(row){
          return row.inPerson + row.outPerson
        }
      }
    },
    from: table,
    groupBy:"region"
  })
  console.log("城市总人口流动分析");
  console.log(data3)


  var data4 = jc.sql({
    select: {
      col:{
        "时间":"time"
      },
      sum: {
        "流入人口总和":"inPerson",
        "流出人口总和":"outPerson",
        "流入流出人口总和":function(row){
          return row.inPerson + row.outPerson
        }
      },
      avg: {
        "流入人口平均数":"inPerson",
        "流出人口平均数":"outPerson",
        "流入流出人口平均数":function(row){
          return row.inPerson + row.outPerson
        }
      }
    },
    from: table,
    groupBy: "time",
    having: {"sum_inPerson+outPerson":">1000"}
  })
  console.log("广深总人口流动大于1000Wd的日期分析");
  console.log(data4)
  var arr = [1,1,2,2,34,5]
  var obj = [{test:113,text:"332"},{test:113 ,text:"332"},{test:1134, text:"332"},{test:1134,text:"332"}];
  var aaa = jc.unique(obj);
  console.log(aaa);
	</script>
</body>
</html>