!function(){function n(n,r,t){return p.isNoVal(n)||p.isNoVal(r)?p.isNoVal(n)?r:n:(t="max"==t?n>r:n<r)?n:r}function r(n){if(!n.from)throw new Error("From is not defined","Error from");if(!n.select)throw new Error("Select is not defined","Error select");!function(n){var r=n.select,e=n.groupBy;if(!(r.sum||r.avg||r.count||r.max||r.min))return;if(r.col&&!n.groupBy)return;var i=t("",r.col);i=l(i);var o=[],u=!1;p.isArray(e)?p.map(e,function(n,r){o.push(n)}):p.isString(e)?o.push(e):p.isFunction(e)&&(o=[e]);for(var c=0,a=i.length;c<a;c++){for(var f=0;f<a;f++){if(i[c]==o[f]){u=!0;break}if(p.isObject(i[c])&&p.isObject(o[f])&&String(i[c])===String(o[f])){u=!0;break}}if(!u)throw new Error("groupBy should contain select.col","Error groupBy");u=!1}}(n)}function t(n,r){var t={};return p.isArray(r)?p.map(r,function(r){t[n+r]=r}):p.isObject(r)?p.forIn(r,function(n,r){t[n]=r}):p.isString(r)&&(t[n+r]=r),t}function e(r,t){var e={},i=r.length,o={};return p.map(r,function(r){p.isObjEmpty(t.colObj)||p.forIn(t.colObj,function(n,t){var i=p.isFunction(t)?t(r):r[t];e[n]=i}),p.isObjEmpty(t.sumObj)||p.forIn(t.sumObj,function(n,t){var i=p.isFunction(t)?t(r):r[t];e[n]?e[n]+=i||0:e[n]=i||0}),p.isObjEmpty(t.avgObj)||p.forIn(t.avgObj,function(n,t){o[n]||(o[n]=0);var i=p.isFunction(t)?t(r):r[t];e[n]?e[n]+=i||0:e[n]=i||0,(i||0==i)&&o[n]++}),p.isObjEmpty(t.maxObj)||p.forIn(t.maxObj,function(t,i){var o=p.isFunction(i)?i(r):r[i];e[t]=n(e[t],o,"max")}),p.isObjEmpty(t.minObj)||p.forIn(t.minObj,function(t,i){var o=p.isFunction(i)?i(r):r[i];e[t]=n(e[t],o,"min")}),p.isObjEmpty(t.countObj)||p.forIn(t.countObj,function(n,t){var o=p.isFunction(t)?t(r):r[t];switch(p.isUndefined(e[n])&&(e[n]=0),n){case"*"==t?n:"count_*":e[n]=i;break;default:p.isUndefined(o)||null==o||e[n]++}})}),p.forIn(t.avgObj,function(n,r){e[n]=e[n]/o[n]}),e}function i(n,r){if(!r)return n;if(p.isObject(r)&&!p.isFunction(r)){var t=s(r),e=l(r);n.sort(function(n,r){for(var i,o,u=t.length,c=0;c<u&&(i=t[c],o=e[c],n[i]===r[i]);c++);if(n[i]!==r[i]){if(n[i]>r[i]||void 0===r[i])return"desc"===o||"DESC"===o?-1:1;if(n[i]<r[i]||void 0===n[i])return"desc"===o||"DESC"===o?1:-1}return"desc"===o||"DESC"===o?r[i]-n[i]:n[i]-r[i]})}else p.isFunction(r)&&n.sort(r);return n}function o(n,r){if(!r&&0!=r)return n;var t=[],e=n.length,i=0;if(p.isNumber(r))e=r>e?e:r;else if(p.isArray(r)){if(r[0]>e)return[];r[0]<e&&(i=r[0]),e=r[0]+r[1]<e?r[0]+r[1]:e}for(;i<e;i++)t.push(n[i]);return t}var u="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global||this,c=(u.jc,Array.prototype),a=Object.prototype;c.push;slice=c.slice,toString=a.toString,hasOwnProperty=a.hasOwnProperty;var f=Array.isArray,s=Object.keys,l=Object.values?Object.values:function(n){return s(n).map(function(r){return n[r]})},p=(Object.create,function(n){return n instanceof p?n:this instanceof p?void(this._wrapped=n):new p(n)});"undefined"==typeof exports||exports.nodeType?u.jc=p:("undefined"!=typeof module&&!module.nodeType&&module.exports&&(exports=module.exports=p),exports.jc=p),p.VERSION="1.1.0",p.map=function(n,r){return p.isArray(n)?n.map(r):[]},p.forIn=function(n,r){if(!p.isObject(n))return{};var t=0;for(var e in n)r(e,n[e],t),t++},p.filter=function(n,r){return p.isArray(n)?n.filter(r):[]},p.where=function(n,r){var t;if(p.isFunction(r))t=p.filter(n,r);else{if(!p.isObject(r))return[];t=p.filter(n,function(n){return s(r).every(function(t){return r[t]===n[t]})})}return t},p.limit=function(n,r){return o(n,r)},p.order=p.orderBy=function(n,r){return i(n,r)},p.tree=function(n,r){r.children||(r.children="children");var t;p.isString(r.retain)?t=[r.retain,r.id,r.parent]:p.isArray(r.retain)?((t=r.retain).push(r.id),t.push(r.parent)):p.isObject(r.retain)?((t=r.retain)[r.id]=r.id,t[r.parent]=r.parent):n=p.extend(!0,[],n),t&&(n=p.sql({select:{col:t},from:n}));var e={},i=p.groupBy(n,function(n){return n[r.id]==r.root&&(e=n),n[r.parent]});return p.map(n,function(n){var t=n[r.id];i[t]&&(n[r.children]=i[t])}),p.isObjEmpty(e)&&(e[r.children]=i[r.root]),e},p.extend=function(){var n,r,t,e,i,o,u=arguments[0]||{},c=1,a=arguments.length,f=!1;for("boolean"==typeof u&&(f=u,u=arguments[1]||{},c++),"object"==typeof u||p.isFunction(u)||(u={}),a===c&&(u=this,--c);c<a;c++)if(null!=(n=arguments[c]))for(r in n)t=u[r],u!==(e=n[r])&&(f&&e&&(p.isObject(e)||(i=p.isArray(e)))?(i?(i=!1,o=t&&p.isArray(t)?t:[]):o=t&&p.isObject(t)?t:{},u[r]=p.extend(f,o,e)):void 0!==e&&(u[r]=e));return u},p.unique=function(n){if(!n||0==n.length)return n;var r={},t=[];p.map(n,function(n){var t=JSON.stringify(n);r[t]=n});return p.forIn(r,function(n,r){t.push(r)}),t},p.spaceFix=function(n,r){if(!n||0==n.length)return n;var t=[];if(n[0][r.key]-r.start>0){(f={})[r.key]=r.start,p.map(r.zeroFill,function(n){f[n]=0}),n.unshift(f)}if(n[n.length-1][r.key]<r.end){(f={})[r.key]=r.end,p.map(r.zeroFill,function(n){f[n]=0}),n.push(f)}for(var e=1,i=n.length;e<i&&!(e>1e4);e++){var o=n[e][r.key]-n[e-1][r.key];if(o<=r.space)t.push(n[e]);else{for(var u=r.space,c=0,a=o/r.space;c<a-1&&!(c>1e4);c++){var f={};f[r.key]=parseInt(n[e-1][r.key])+parseInt(u),p.map(r.zeroFill,function(n){f[n]=0}),t.push(f),u+=r.space}t.push(n[e])}}return t.unshift(n[0]),t},p.keyArray=function(n,r){if(!n||0==n.length)return n;p.isString(r)&&(r=[r]);var t={};return p.map(n,function(n,e){p.map(r,function(r,e){t[r]||(t[r]=[]),t[r].push(n[r])})}),t},p.keyBreak=function(n,r){if(!n||0==n.length)return n;var t=[],e=r.key,i=r.value;return p.map(n,function(n){p.map(r.break,function(o){var u={};u[e]=o,u[i]=n[o],p.map(r.retain,function(r){u[r]=n[r]}),t.push(u)})}),t},p.index=function(n,r){if(!n||0==n.length)return n;var t={};return p.map(n,function(n){console.log(n.key),t[n[r]]=n}),t},p.max=function(n,r){if(!n||0==n.length)return n;var t;if(p.isString(r)){var e=r;r=function(n){return n[e]}}else p.isUndefined(r)&&(r=function(n){return n});return p.map(n,function(n){var e=t?r(t):t,i=n?r(n):n;t=p.isNoVal(e)||p.isNoVal(i)?p.isNoVal(e)?n:t:e>i?t:n}),t},p.min=function(n,r){if(!n||0==n.length)return n;var t;if(p.isString(r)){var e=r;r=function(n){return n[e]}}else p.isUndefined(r)&&(r=function(n){return n});return p.map(n,function(n){var e=t?r(t):t,i=n?r(n):n;t=p.isNoVal(e)||p.isNoVal(i)?p.isNoVal(e)?n:t:e<i?t:n}),t},p.group=p.groupBy=function(n,r){if(!n||0==n.length)return n;var t={};return p.map(n,function(n,e){var i=[];p.isArray(r)?p.map(r,function(r,t){p.isFunction(r)?i.push(r(n)):i.push(n[r])}):p.isString(r)?i.push(n[r]):p.isFunction(r)&&(i=r(n,e)),t[i]||(t[i]=[]),t[i].push(n)}),t},p.sql=function(n){if(r(n),0==n.from.length||!p.isArray(n.from))return[];var u,c,a,f,s;return u=function(n,r){return r?p.where(n,r):n}(n.from,n.where),c=function(n,r){var t;return p.forIn(r.select,function(n,r){t=!("col"==n)||t}),r.groupBy||t?r.groupBy||r.select.col?p.group(n,r.groupBy):{table:n}:n}(u,n),a=function(n,r){if(!r)return n;var t={sumObj:{},avgObj:{},maxObj:{},minObj:{},countObj:{}},i={};return p.forIn(r,function(n,r){var e=n.split("_"),i=e.shift(),o=e.join("_");switch(o=o.replace(/[1-9a-zA-z_\$\@]+/g,function(n){return"row['"+n+"']"}),i){case"sum":t.sumObj[n]=function(n){return new Function("row","return "+o)(n)};break;case"avg":t.avgObj[n]=function(n){return new Function("row","return "+o)(n)};break;case"max":t.maxObj[n]=function(n){return new Function("row","return "+o)(n)};break;case"min":t.minObj[n]=function(n){return new Function("row","return "+o)(n)};break;case"count":t.countObj[n]=function(n){return new Function("row","return "+o)(n)}}}),p.forIn(n,function(n,o,u,c){var a,f=e(o,t);for(var s in r)if(foo=new Function("return "+f[s]+r[s]),!(a=foo()))break;a&&(i[n]=o)}),i}(c,n.having),f=function(n,r){if(!r)throw new Error("Select is not defined","Error select");var i=[],o={};return r.col&&(o.colObj=t("",r.col)),r.sum&&(o.sumObj=t("sum_",r.sum)),r.avg&&(o.avgObj=t("avg_",r.avg)),r.max&&(o.maxObj=t("max_",r.max)),r.min&&(o.minObj=t("min_",r.min)),r.count&&(o.countObj=t("count_",r.count)),p.isArray(n)?p.map(n,function(n,r){var t=e([n],o);i.push(t)}):p.forIn(n,function(n,r,t,u){var c=e(r,o);i.push(c)}),i}(a,n.select),s=i(f,n.orderBy),o(s,n.limit)},p.isObjEmpty=function(n){for(var r in n)return!1;return!0},p.isNoVal=function(n){return p.isUndefined(n)||null==n||n!=n},p.isArray=f||function(n){return"[object Array]"===toString.call(n)},p.isObject=function(n){return"object"===typeof n&&!p.isArray(n)&&!!n},p.map(["Arguments","Function","String","Number","Date","RegExp","Error","Symbol","Map","WeakMap","Set","WeakSet"],function(n){p["is"+n]=function(r){return toString.call(r)==="[object "+n+"]"}}),p.isUndefined=function(n){return void 0===n},"function"==typeof define&&define.amd&&define("jc",[],function(){return p})}();